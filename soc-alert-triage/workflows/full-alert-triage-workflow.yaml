workflow_name: full_alert_triage
description: "Pipeline completo de triagem de alertas SOC ‚Äî da classifica√ß√£o inicial ao brief para analista, integrando filtragem de falsos positivos, prioriza√ß√£o por risk score, enriquecimento com threat intel e gera√ß√£o de brief acion√°vel"

agent_sequence:
  - alert-classifier
  - false-positive-filter
  - threat-prioritizer
  - context-enricher
  - analyst-brief-generator

key_commands:
  - "*triage-full"
  - "*full-triage"

trigger_threshold: 1
typical_duration: "30-60 minutes"

success_indicators:
  - "100% dos alertas classificados com tipo e severidade"
  - "Falsos positivos filtrados com justificativa documentada"
  - "Amea√ßas priorizadas por risk score composto"
  - "IOCs extra√≠dos e correlacionados com threat intel"
  - "Brief acion√°vel gerado para analista SOC"

transitions:
  alerts_classified:
    trigger: "Alertas classificados ‚Äî tipo, severidade e MITRE ATT&CK mapeados"
    confidence: 0.90
    greeting_message: "üè∑Ô∏è Alertas classificados. Filtrando falsos positivos."
    next_steps:
      - command: "*filter-fps"
        args_template: "--classifiedAlerts=classification-report.md"
        description: "Filtrar falsos positivos usando baselines e padr√µes conhecidos"
        priority: 1

  fps_filtered:
    trigger: "Falsos positivos filtrados ‚Äî alertas reais separados com justificativas"
    confidence: 0.90
    greeting_message: "üõ°Ô∏è FPs filtrados. Priorizando amea√ßas reais."
    next_steps:
      - command: "*prioritize"
        args_template: "--filteredAlerts=filtered-alerts.json"
        description: "Priorizar amea√ßas reais por risk score composto"
        priority: 1

  threats_prioritized:
    trigger: "Amea√ßas priorizadas ‚Äî risk scores calculados e ordem de resposta definida"
    confidence: 0.90
    greeting_message: "‚ö° Amea√ßas priorizadas. Enriquecendo contexto."
    next_steps:
      - command: "*enrich"
        args_template: "--prioritizedAlerts=prioritized-alerts.json"
        description: "Enriquecer alertas com IOCs, MITRE ATT&CK e threat intel"
        priority: 1

  context_enriched:
    trigger: "Contexto enriquecido ‚Äî IOCs, MITRE ATT&CK e threat intel adicionados"
    confidence: 0.95
    greeting_message: "üîç Contexto enriquecido. Gerando brief para analista."
    next_steps:
      - command: "*generate-brief"
        args_template: "--enrichedAlerts=enriched-alerts.json"
        description: "Gerar brief executivo para analista SOC"
        priority: 1

  brief_generated:
    trigger: "Brief gerado ‚Äî timeline, playbook e a√ß√µes de resposta documentados"
    confidence: 0.95
    greeting_message: "üìä Triagem completa! Brief dispon√≠vel para o analista."
    next_steps:
      - command: "*generate-brief"
        args_template: "--enrichedAlerts=enriched-alerts.json --format=executive"
        description: "Opcional: gerar vers√£o executiva do brief para gest√£o"
        priority: 2
